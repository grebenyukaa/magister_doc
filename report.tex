\input{report-header.tex}
\input{math-shortcuts.tex}

\begin{document}
%skip for title page
\textbf{\large{Реферат}}.

Отчёт \pageref{LastPage}с., \totalfigures рис., \totaltables табл., 
TODO источников.

\noindent \textbf{ Локализация, Построение карты местности, Одновременная локазизация и построение карты местности, SLAM, Многоагентная SLAM }

Работа направлена на разработку метода решения задачи одновременной локализации и построения карты местности множеством агентов.
Цель работы -- разработка ПО, реализующего модифицированный метод одновременной локализации и построения трехмерной карты местности множеством независимых агентов, получающих информацию об окружении при помощи одной RGB камеры, в режиме, близком к реальному времени.

Сформированы требования к методу, отвечающие современным характеристикам автономных беспилотных летательных аппаратов потребительского класса. В результате сравнительного анализа существующих решений указанной проблемы SLAM предложена модификация существующего одноагентного метода LSD-SLAM. Модификация позволяет расширить метод на многоагентный случай. По результатам разработки ПО и проведения тестирования на находящихся в открытом доступе наборах данных проведено исследование модификации метода по параметрам точности локализации, скорости работы и визуальной оценки качества получаемой трехмерной карты. По результатам исследования сделан вывод о работоспособности разработанной модификации метода.

\setcounter{page}{5}
\tableofcontents

\section{Введение}
В данной работе идет речь о построении трехмерной карты местности множеством агентов, на основе некоторой информации об окружении, получаемой ими независимо друг от друга. Эта задача имеет множество
вариантов решения, в зависимости от вычислительной мощности агентов, их оснащения для получения информации об окружающей среде и допустимых энергетических затратах агентов на передвижение. Также, вариант решения задачи может максимизировать точность построения карты и ее качество или делать упор на максимизацию скорости определения местоположения в пространстве. Все эти факторы определяют требования к методу
решения задачи SLAM, набор алгоритмов, необходимых для локализации в пространтстве на основе набора извлеченных некоторым образом его характеристик, формат представления карты и набор алгоритмов построения карты. Наименее исследованной областью является построение трехмерной карты местности в режиме реального времени с аппаратными требованиями к агенту на уровне доступной любительской техники~\cite{SLAMoverview}


Актуальность выбранной темы обусловлена набором задач, автоматизация которых возможна при помощи одного или нескольких беспилотных наземных или летательных аппаратов, например:
\begin{itemize}
    \item решение сложных задач группового взаимодействия, при котором агентам необходимо иметь информацию о положении друг относительно друга (логистические задачи доставки определенных грузов или предметов без привязки к априорно изветной карте местности, где выгоду приносит возможность передачи предметов между агентами)~\cite{beerSLAM};
    \item навигация беспилотных наземных транспортных средств, где построение карты местности позволяет обновлять информацию о текущей дорожной ситуации~\cite{kittyDataset};
    \item построение карты местности объектов с затрудненным доступом для человека, вследствие природных, техногенных и иных факторов~\cite{tum3DMonoSLAM};
    \item построение трехмерных карт объектов исторической и культурной ценности.
\end{itemize}
Возрастающие аппаратные возможности простых беспилотных летательных аппаратов, таких как квадрокоптеры, обуславливает тенденцию роста~\cite{tum3DMonoSLAM} популярности темы данной работы.


Целью работы является разработка метода одновременной локализации и построения карты местности, сочетающего в себе ряд следующих характеристик:
\begin{itemize}
    \item локализация и построение карты местности производятся в реальном или близком к реальному времени (20 -- 60 кадров в секунду);
    \item метод обеспечивает построение трехмерной карты местности;
    \item метод предъявляет низкие(соответствующие современным квадрокоптерам) требования к аппаратному обеспечению и вычислительной мощности беспилотного аппарата, являющегося агентом;
    \item метод не требует специализированных устройств(таких как лидары, дальномеры) для получения информации об окружающей среде - допускается использование обычной поративной RGB камеры.
\end{itemize}
 

Для достижения посталенной цели необходимо решить следующие задачи:
\begin{itemize}
    \item извлечение информации о удаленности и масштабе объектов окружения агента;
    \item определение собственной скорости движения агентом на основе извлеченных данных об окружении;
    \item локализация в пространстве на основе извлеченной информации о расстоянии до объектов окружения и скорости передвижения;
    \item построение трехмерной карты местности на основе извлеченных данных о расстояниях до предметов окружения и локализации;
    \item разработка ПО для демонстрации и тестирования данного метода с использованием публично доступных наборов данных.
\end{itemize}

\section{Аналитический раздел}
\subsection{Введение}
В данном разделе приводится краткий обзор существующих методов решения SLAM. Производится сравнительный анализ алгоритмов, решающих поставленные задачи, делается вывод о обосновании выбора конкретных алгоритмов для решения поставленных задач.

\subsection{Локализация}
Существует два фундаментальных подхода к локализации:
\begin{itemize}
    \item формирование списка неподвижных опорных точек, извлеченных из окружения, и локализация на основе оценки положения опорных точек в каждый следующий момент времени;
    \item формирование списка ключевых кадров и локализация на основе вычисления аффинного преобразования от предыдущего кадра к последующему.
\end{itemize}


Первый подход используется в марковских методах~\cite{MDPSLAM} и методах, использующих фильтр Калмана~\cite{EKFSLAM}. Общий алгоритм локализации в таком случае состоит из двух операций: составления предположения о собсвенном местоположении в пространстве, на основе имеющихся данных о предыдущем местоположении и параметров движения, и уточнения оценки местоположения в пространстве, опираясь на новое измерение положения неподвижных опорных точек. Главным недостатком данных подходов является привязка к объектам окружения, которые в общем случае не являются неподвижными, что приводит к необходимости распознавания объектов окружения или введения механизма удаления опорных точек, что отражается на скорости работы алгоритма и его сходимости~\cite{EKFSLAM}. Также, ввиду того, что эти методы хранят информацию только о опорных точках, принципиально невозможно их использование для выполнения задачи построения карты местности.


Второй подход наиболее полно отвечает поставленной задаче, т.к. побочная информация этапа локализации может быть непосредственно использована для решения задачи построения карты местности. Алгоритм локализации по методу извлечения ключевых кадров сводится к вычислению аффинного преобразования текущего обозреваемого окружения к одному или нескольким имеющимся ключевым кадрам, положение в пространстве которых уже вычислено в процессе их извлечения, а положение первого ключевого кадра находится в начале координат. Локализация этим методом так же подразделяется на две фундаментально различные группы методов: извлекающие информацию из входного потока данных при помощи распознавания некоторых особенностей предметов, таких как наличие прямых или скругленных линий, и работающие напрямую со всей входной информацией без предварительного распознавания объектов окружения. Алгоритмы локализации на основе извлечения ключевых кадров с распознаванием объектов окружения являются более простыми с точки зрения реализации, поскольку для определения нового положения и параметров движения агента достаточно обработать только небольшую часть данных входного потока информации. Однако именно это преимущество определяет существенный недостаток - невозможность работы в окружениях, лишенных указанных при разработке алгоритма распознаваемых особенностей~\cite{tum3DMonoSLAM}. Таким образом, можно сделать вывод, что для реализации задачи локализации в трехмерном пространстве, сопряженной с последующим построением карты местности, следует использовать алгоритм локализации на основе ключевых кадров без распознавания особенностей окружения.


\subsection{Построение карты местности}
Формат представления карты и алгоритм ее построения являются сильно зависимыми от алгоритма локализации, т.к. побочным результатом выполнения задачи локализации является набор информации о положении объектов окружения. Исходя из того, что наиболее полно поставленной задаче локализации отвечает алгоритм на основе ключевых кадров, будут рассмотрены только алгоритмы построения карты местности, входными данными для которых является последовательность кадров окружения. В таком случае естественно следующим из структуры входных данных способом представления карты является неориентированный граф $G(K, E),$ где множество вершин $K$ -- это множество ключевых кадров, а множество дуг $E = K x K$ определяется последовательностью возникновения ключевых кадров во входной последовательности и обнаружением циклов в траектории движения агента.


Таким образом можно сделать вывод о том, что для решения задачи построения карты местности необходимо решить две поздазачи:
\begin{itemize}
    \item обновления карты при получении нового ключевого кадра,
    \item поиска циклов при добавлении нового ключевого кадра.
\end{itemize}


Конкретные алгоритмы решения этих подзадач определяются выбором математического аппарата представления положения агента в пространстве.


\subsection{Математический аппарат}
Существует множество подходов к представлению положения объекта в пространстве, каждый из которых является наиболее удобным для реализации алгоритма локализации. С учетом того, что локализация на основе ключевых кадров наиболее полно отвечает постановке задачи, необходим математический аппарат, способный успростить вычисление аффинных преобразований и упростить вычисление операций над этими преобразованиями, таких как композиция, вычисление обратного преобразования, вычисление якобиана и гессиана.


Из необходимости получения трехмерной карты следует, что все преобразования имею 7 степеней свободы - 3 вращательных, 3 поступательных и масштабирование. Эти операции могут быть обобщены с помощью двух математических аппаратов - использования кватернионов и использования групп Ли. В трехмерном пространтве все указанные аффинные преобразования задаются матрицей
\begin{equation}
    \begin{pmatrix}
    \mathbf{R} & \mathbf{t}  \\
    \mathbf{0} & \frac{1}{s} \\
    \end{pmatrix}
\end{equation}
,где $\mathbf{R}: 3x3$ -- матрица поворота, $\mathbf{t} \in \mathbb{R}^3$ -- вектор переноса, $s$ -- масштаб.


Наиболее полно предъявленным требованиям к математическому аппарату овечает алгебра Ли, оперирующая аффинными трансформациями в пространстве размерности равной числу степеней свободы($\mathbf{Sim3}$). Засчет введения дополнительных размерностей пространства, основные операции над матрицей преобразования могут быть существенно упрощены~\cite{lieGroups}:
\begin{itemize}
    \item композиция преобразований
    \begin{equation}
        \begin{pmatrix}
        \mathbf{R_1} & \mathbf{t_1}  \\
        \mathbf{0} & \frac{1}{s_1} \\
        \end{pmatrix}
        \cdot
        \begin{pmatrix}
        \mathbf{R_2} & \mathbf{t_2}  \\
        \mathbf{0} & \frac{1}{s_2} \\
        \end{pmatrix}
        =
        \begin{pmatrix}
        \mathbf{R_1}\mathbf{R_2} & \mathbf{R_1}\mathbf{t_2} + \frac{\mathbf{t_1}}{\mathbf{s_2}}  \\
        \mathbf{0} & \frac{1}{s_1 s_2} \\
        \end{pmatrix}, \mathbf{R_i} \in \mathbf{SO}(3), \mathbf{t} \in \mathbb{R}^3, s_i \in \mathbb{R}, i = \bar{1,2}
    \end{equation}
    \item вычисление обратной матрицы
    \begin{equation}
        \begin{pmatrix}
        \mathbf{R} & \mathbf{t}  \\
        \mathbf{0} & \frac{1}{s} \\
        \end{pmatrix}
        ^{\!\!-1}
        =
        \begin{pmatrix}
        \mathbf{R}^T & -s\mathbf{R}^T\mathbf{t} \\
        \mathbf{0} & s_1 \\
        \end{pmatrix}, \mathbf{R} \in \mathbf{SO}(3), \mathbf{t} \in \mathbb{R}^3, s \in \mathbb{R}
    \end{equation}
    \item вычисление якобиана существенно упрощается, засчёт упрощения дифференцирования по параметрам преобразования
    \begin{equation}
        \begin{align*}
            \mathbf{y} = \mathbf{R}\mathbf{x} \\
            \frac{\partial\mathbf{y}}{\partial\mathbf{R}}
            = -\mathbf{y} \cdot
            \begin{pmatrix}
            0 & -1 & 1 \\
            1 & 0 & -1 \\
            -1 & 1 & 0 \\
            \end{pmatrix}
        \end{align*}
    \end{equation}
\end{itemize}


Альтернативным математическим аппаратом для эффективной по времени работы с матрицами аффинных преобразований трехмерного евклидового пространства являются кватернионы, выполняющие эти преобразования в четырехмерном пространтве, однако вычисление якобиана при помощи этого аппарата является задачей, по времени выполнения сравнимой с классическим вычислением якобиана, что является недостатком этого математического аппарата, с точки зрения указанных требований. Таким образом, задача локализации будет выполняться в алгебре Ли $\textbf{Sim}(3)$.


\subsection{Получение информации об окружении}
Согласно постановке задачи, метод должен предъявлять минимальные треования по аппаратному обеспечению робота, особенно в части средств получения информации об окружающей среде. Исходя из выбора алгоритма локализации следует, что необходимо получать поток снимков окружающей среды в режиме, близком к реальному времени, что может быть выполнено при помощи обычной RGB камеры. Вследствие отсутствия возможности измерения глубины объектов сцены, основным недостатком данного метода будет являться накопительная погрешность оценки масштаба элементов сцены~\cite{tum3DMonoSLAM}. Этот недостаток добавляет новую подзадачу к задаче построения карты местноти -- учет погрешности масштаба.


\subsection{Существующие аналоги}
Существует множество методов, решающих разные варинанты SLAM, специализирующиеся на повышении эффективности отдельных подзадач. Наиболее близкими к данному методу являются(все они используют одну камеру для получения информации об окружении):
\begin{itemize}
    \item 3D-Plane-SLAM~\cite{3DPlaneSLAM}\\
    метод позволяет строить трехмерную карту местности неизвестного окружения в реальном времени с использованием математического аппарата кватернионов. Метод использует локализацию на основе ключевых кадров. Для обновления карты местности, при получении нового ключевого кадра, применяется итеративное приближение облака точек. Достониствами метода является качетсво распознавания поворотов агента на большие углы, при малом перемещении. Недостатком является невысокая плотность облака точек, использование метода локализации на основе распознаваемых параметров окружения. Метод не имеет многоагентного решения, однако может быть масштабирован на множество агентов;
    \item CSfM~\cite{CSFMSLAM}\\
    метод позволяет строить трехмерную карту местности неизвестного окружения множеством агентов в реальном времени. Используется локализация на основе ключевых кадров с распознаванием параметров окружения. Основным недостатком метода является крайне низкая плотность облака точек, практически не позволяющая визуально распознать объекты трехмерной сцены;
    \item LSD-SLAM~\cite{tum3DMonoSLAM}\\
    метод позволяет строить трезмерную карту местности в режиме, близком к реальному времени, с использованием математического аппарата алгебры Ли. Метод применяет локализацию на основе ключевых кадров без распознавания объектов окружения. Для представления карты местности метод использует граф зависимостей ключевых кадров и хранит карту местности в виде облака точек. Единственным недостатком метода является отсутствие многоагетного решения, и может быть промасштабирован на многоагентный случай.
\end{itemize}
Исходя из анализов аналогичных решений, можно сделать вывод, что метод LSD-SLAM наиболее полно отвечает постановке задачи, а отсутствие многоагентного решения может быть устранено. Этот метод будет использоваться как алгоритм выполнения одноагентного SLAM в текущеё работе.


\subsection{Вывод}
Сформулированы требования к методу. Выбраны алгоритмы, необходимые для реализации поставленных задач. По результатам анализа предметной области, поставленная цель может быть достигнута решением следующих задач:
\begin{itemize}
    \item локализация по методу определения ключевых кадров без распознавания отличительных особенностей преметов окружения;
    \item построение трехмерной карты местности, подразделяемое на
    \begin{itemize}
        \item обновление карты при добавлении нового ключевого кадра путем вычисления аффинного преобразования в $\textbf{Sim}(3)$,
        \item поиск циклов для устранения погрешностей обновления карты;
    \end{itemize}
    \item разработка ПО для демонстрации и тестирования данного метода с использованием публично доступных наборов данных.
\end{itemize}
Исходя из сравнителного анализа аналогов разрабтываемого метода, следует, что для достижения цели работы достаточно разработать модификацию метода одовременной локализации и построения трехмерной карты местности -- ``LSD-SLAM'', а именно его масштабирование на многоагентный случай.




\section{Конструкторский раздел}
\subsection{Введение}

\subsection{Структура ПО}
Idef0-2

\subsection{Вывод}



\section{Технологический раздел}
\subsection{Введение}
\subsection{Выбор языка программирования}
\subsection{Выбор программных средств}

\begin{table}[h]
    \caption{Использованные при разработке программные средства}
    \centering
    \begin{tabu}{|>{\centering}p{3.5cm}|>{\centering}p{2.3cm}|X[c]|}
    	\hline
    	Название                         & Версия           & 
    	Назначение                                                \\ \hline
    	\hline
    \end{tabu}
    \label{tab:software}
\end{table}

\subsection{Входные данные}

\subsection{Выходные данные}

\subsection{Тестирование}

\section{Исследовательский раздел}
\subsection{Введение}

\subsection{Вывод}

\section{Заключение}

\section{Список литературы}
\nocite{datasetList, rgbdBenchmark, msds}
\printbibliography[heading=none]

\end{document}
